<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Regine's Birthday Adventure</title>
  <style>
    body { margin: 0; background: #000; overflow: hidden; }
    canvas { image-rendering: pixelated; background: #70c6ff; }
  </style>
</head>
<body>
  <canvas id="game" width="320" height="320"></canvas>
  <script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const TILE = 32, MAP = 10;

    // Load a simple girl sprite sheet: (4 directions Ã— 2 frames)
    const sprite = new Image();
    sprite.src = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAAAAABf3vZA..." ; // placeholder, will replace

    const player = { x: 1, y: 1, dir: 2, frame: 0, moving: false, moveProgress: 0 };
    const levels = [/* same maps as before, portals etc. */];

    function drawMap() { /* similar to previous version */ }

    function drawPlayer() {
      const px = player.x * TILE, py = player.y * TILE;
      const fx = player.frame * 16, fy = player.dir * 16;
      ctx.drawImage(sprite, fx, fy, 16, 16, px+8, py+8, 16, 16);
    }

    function render() {
      drawMap();
      drawPlayer();
    }

    function step(direction) {
      if (player.moving) return;
      player.dir = ["up","right","down","left"].indexOf(direction);
      const dx = direction === "left" ? -1 : direction==="right"?1:0;
      const dy = direction === "up"?-1:direction==="down"?1:0;

      const nl = levels[player.level];
      const tx = player.x + dx, ty = player.y + dy;
      if (nl[ty]?.[tx] !== 1) {
        player.moving = true;
        player.moveProgress = 0;
        player.destX = tx;
        player.destY = ty;
      }
    }

    function update() {
      if (player.moving) {
        player.moveProgress += 4;
        if (player.moveProgress >= TILE) {
          player.x = player.destX;
          player.y = player.destY;
          player.moving = false;
        }
        player.frame = Math.floor(player.moveProgress / (TILE / 2)) % 2;
      } else {
        player.frame = 0;
      }
    }

    document.addEventListener('keydown', e => {
      if (e.key.startsWith("Arrow")) {
        const dir = {"ArrowUp":"up","ArrowDown":"down","ArrowLeft":"left","ArrowRight":"right"}[e.key];
        step(dir);
      }
    });

    sprite.onload = () => {
      setInterval(() => {
        update();
        render();
      }, 1000 / 30);
    };
  </script>
</body>
</html>
